---
title: Runloop
date: 2020-06-08 11:25
---

### 1、app如何接收到触摸事件的
**UITouch：**一个手指一次触摸屏幕，就对应生成一个UITouch对象；每个UITouch对象记录了触摸的一些信息，包括触摸时间、位置、阶段、所处的视图、窗口等信息
**UIEvent：**一个触摸事件对应一个UIEvent对象；UIEvent对象中包含了触发该对象的触摸对象集合，因为一个触摸事件可能是由多个手指同时触摸产生的。触摸对象集合通过allTouches属性获取
**UIResponder：**

* 应用程序接收到触摸事件后，将事件放入UIApplication的事件队列，等到处理该事件时，将该事件出队列，UIApplication将事件传递给窗口对象(UIWindow)，如果存在多个窗口，则优先询问后显示的窗口
* 如果窗口UIWindow不能响应事件，则将事件传递给其他窗口；若窗口能响应事件，则从后往前询问窗口的子视图
* 以此类推，如果视图不能响应事件，则将事件传递给同级的上一个子视图；如果能响应，就从后往前遍历当前视图的子视图。
* 如果当前视图的子视图都不能响应事件，则当前视图就是最合适的响应者。

### 2、为什么只有主线程的runloop是开启的
对于主线程来说，runloop在程序一启动就默认创建好了
对于子线程来说，runloop是懒加载的，只有当我们使用的时候才会创建，所以在子线程用定时器要注意：确保子线程的runloop被创建，不然定时器不会回调
### 3、为什么只能在主线程刷新UI

### 4、PerformSelector和runloop的关系

### 5、如何使线程保活

### 5、Runloop 和线程的关系
* 一个线程对应一个 Runloop
* 主线程的默认就有了 Runloop
* 子线程的 Runloop 以懒加载的形式创建
* Runloop 存储在一个全局的可变字典里，线程是 key ，Runloop 是 value